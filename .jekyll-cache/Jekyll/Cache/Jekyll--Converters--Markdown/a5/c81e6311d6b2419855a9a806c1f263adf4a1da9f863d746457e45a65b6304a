I"ª<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span><span class="p">;</span> <span class="n">sns</span><span class="p">.</span><span class="nb">set</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
</code></pre></div></div>

<h2 id="ì„ í˜•íšŒê·€linear-regresion">ì„ í˜•íšŒê·€(Linear Regresion)</h2>
<p>ë¨¼ì €, ì£¼ì–´ì§„ ë°ì´í„°ë¥¼ ì§ì„ ì„ ì‚¬ìš©í•´ ëª¨ë¸ë§ í•˜ëŠ” ë°©ë²•ì„ ì‚´í´ë³¸ë‹¤. ì§ì„ í•¨ìˆ˜ëŠ” ë‹¤ìŒê³  ê°™ì€ í˜•íƒœë¥¼ ê°€ì§„ë‹¤. <br />
$y = ax + b$ <br />
ì—¬ê¸°ì„œ aëŠ” ê¸°ìš¸ê¸°(slope)ì´ê³  bëŠ” yì ˆí¸ (intercept)ë¼ê³  ë¶ˆë¦°ë‹¤. <br />
ì•„ë˜ ê·¸ë˜í”„ëŠ” ê¸°ìš¸ê¸°ê°€ 2ì´ê³  yì ˆí¸ì´ -5ì¸ ì§ì„ ìœ¼ë¡œë¶€í„° ìƒì„±ëœ ë°ì´í„°ë¥¼ ë³´ì—¬ì¤€ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">rng</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">rng</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.collections.PathCollection at 0x7fcb82128ed0&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/51064261/103624985-a99bd300-4f7d-11eb-8d0c-10b267c0fbf9.png" alt="ML_Basics(Linear Regression)_2_1" /></p>

<p>Scikit-Learnì˜ <strong>LinearRegression</strong> estimatorë¥¼ ì‚¬ìš©í•´ì„œ ìœ„ ë°ì´í„°ë¥¼ ê°€ì¥ ì˜ í‘œí˜„í•˜ëŠ” ì§ì„ ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

<span class="c1">#x[:,np.newaxis]ëŠ” xì˜ ì°¨ì›ì„ ëŠ˜ë ¤ì£¼ëŠ” ì—­í• ì„ í•¨. xì˜ shapeëŠ” (50,0) ìƒˆë¡œìš´ shapeëŠ” (50,1)
</span><span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>

<span class="n">xfit</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">yfit</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xfit</span><span class="p">[:,</span> <span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">])</span>

<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xfit</span><span class="p">,</span> <span class="n">yfit</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[&lt;matplotlib.lines.Line2D at 0x7fcb83649690&gt;]
</code></pre></div></div>

<p><img src="ML_Basics%28Linear%20Regression%29_files/ML_Basics%28Linear%20Regression%29_4_1.png" alt="png" /></p>

<p>ëª¨ë¸ í•™ìŠµì´ ëë‚œ í›„ í•™ìŠµëœ íŒŒë¼ë¯¸í„°ë“¤ì€ model.â€íŒŒë¼ë¯¸í„°ì´ë¦„â€_ì˜ í˜•íƒœë¡œ ì €ì¥ëœë‹¤. ê¸°ìš¸ê¸°ì™€ yì ˆí¸ì€ ì•„ë˜ì™€ ê°™ì´ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"Model slope: "</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Model intercept: "</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">intercept_</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Model slope:  2.027208810360695
Model intercept:  -4.998577085553202
</code></pre></div></div>

<p>LinearRegression estimatorëŠ” ìœ„ì˜ ì˜ˆì œì™€ ê°™ì€ 1ì°¨ì› ì…ë ¥ë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ì°¨ì› ì…ë ¥ì„ ì‚¬ìš©í•œ ì„ í˜•ëª¨ë¸ì„ ë‹¤ë£° ìˆ˜ ìˆë‹¤. ë‹¤ì°¨ì› ì„ í˜•ëª¨ë¸ì€ ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¥¼ ê°€ì§„ë‹¤.
$y = a_0 + a_1x_1 + a_2_x_2 + â€¦$
ê¸°í•˜í•™ì ìœ¼ë¡œ ì´ê²ƒì€ hyper-planeìœ¼ë¡œ ë°ì´í„°ë¥¼ í‘œí˜„í•˜ëŠ” ê²ƒì´ë¼ê³  ë§í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rng</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([[4.17022005e-01, 7.20324493e-01, 1.14374817e-04],
       [3.02332573e-01, 1.46755891e-01, 9.23385948e-02],
       [1.86260211e-01, 3.45560727e-01, 3.96767474e-01],
       [5.38816734e-01, 4.19194514e-01, 6.85219500e-01],
       [2.04452250e-01, 8.78117436e-01, 2.73875932e-02],
       [6.70467510e-01, 4.17304802e-01, 5.58689828e-01],
       [1.40386939e-01, 1.98101489e-01, 8.00744569e-01],
       [9.68261576e-01, 3.13424178e-01, 6.92322616e-01],
       [8.76389152e-01, 8.94606664e-01, 8.50442114e-02],
       [3.90547832e-02, 1.69830420e-01, 8.78142503e-01],
       [9.83468338e-02, 4.21107625e-01, 9.57889530e-01],
       [5.33165285e-01, 6.91877114e-01, 3.15515631e-01],
       [6.86500928e-01, 8.34625672e-01, 1.82882773e-02],
       [7.50144315e-01, 9.88861089e-01, 7.48165654e-01],
       [2.80443992e-01, 7.89279328e-01, 1.03226007e-01],
       [4.47893526e-01, 9.08595503e-01, 2.93614148e-01],
       [2.87775339e-01, 1.30028572e-01, 1.93669579e-02],
       [6.78835533e-01, 2.11628116e-01, 2.65546659e-01],
       [4.91573159e-01, 5.33625451e-02, 5.74117605e-01],
       [1.46728575e-01, 5.89305537e-01, 6.99758360e-01],
       [1.02334429e-01, 4.14055988e-01, 6.94400158e-01],
       [4.14179270e-01, 4.99534589e-02, 5.35896406e-01],
       [6.63794645e-01, 5.14889112e-01, 9.44594756e-01],
       [5.86555041e-01, 9.03401915e-01, 1.37474704e-01],
       [1.39276347e-01, 8.07391289e-01, 3.97676837e-01],
       [1.65354197e-01, 9.27508580e-01, 3.47765860e-01],
       [7.50812103e-01, 7.25997985e-01, 8.83306091e-01],
       [6.23672207e-01, 7.50942434e-01, 3.48898342e-01],
       [2.69927892e-01, 8.95886218e-01, 4.28091190e-01],
       [9.64840047e-01, 6.63441498e-01, 6.21695720e-01],
       [1.14745973e-01, 9.49489259e-01, 4.49912133e-01],
       [5.78389614e-01, 4.08136803e-01, 2.37026980e-01],
       [9.03379521e-01, 5.73679487e-01, 2.87032703e-03],
       [6.17144914e-01, 3.26644902e-01, 5.27058102e-01],
       [8.85942099e-01, 3.57269760e-01, 9.08535151e-01],
       [6.23360116e-01, 1.58212428e-02, 9.29437234e-01],
       [6.90896918e-01, 9.97322850e-01, 1.72340508e-01],
       [1.37135750e-01, 9.32595463e-01, 6.96818161e-01],
       [6.60001727e-02, 7.55463053e-01, 7.53876188e-01],
       [9.23024536e-01, 7.11524759e-01, 1.24270962e-01],
       [1.98801338e-02, 2.62109869e-02, 2.83064880e-02],
       [2.46211068e-01, 8.60027949e-01, 5.38831064e-01],
       [5.52821979e-01, 8.42030892e-01, 1.24173315e-01],
       [2.79183679e-01, 5.85759271e-01, 9.69595748e-01],
       [5.61030219e-01, 1.86472894e-02, 8.00632673e-01],
       [2.32974274e-01, 8.07105196e-01, 3.87860644e-01],
       [8.63541855e-01, 7.47121643e-01, 5.56240234e-01],
       [1.36455226e-01, 5.99176895e-02, 1.21343456e-01],
       [4.45518785e-02, 1.07494129e-01, 2.25709339e-01],
       [7.12988980e-01, 5.59716982e-01, 1.25559802e-02],
       [7.19742797e-02, 9.67276330e-01, 5.68100462e-01],
       [2.03293235e-01, 2.52325745e-01, 7.43825854e-01],
       [1.95429481e-01, 5.81358927e-01, 9.70019989e-01],
       [8.46828801e-01, 2.39847759e-01, 4.93769714e-01],
       [6.19955718e-01, 8.28980900e-01, 1.56791395e-01],
       [1.85762022e-02, 7.00221437e-02, 4.86345111e-01],
       [6.06329462e-01, 5.68851437e-01, 3.17362409e-01],
       [9.88616154e-01, 5.79745219e-01, 3.80141173e-01],
       [5.50948219e-01, 7.45334431e-01, 6.69232893e-01],
       [2.64919558e-01, 6.63348344e-02, 3.70084198e-01],
       [6.29717507e-01, 2.10174010e-01, 7.52755554e-01],
       [6.65364814e-02, 2.60315099e-01, 8.04754564e-01],
       [1.93434283e-01, 6.39460881e-01, 5.24670309e-01],
       [9.24807970e-01, 2.63296770e-01, 6.59610907e-02],
       [7.35065963e-01, 7.72178030e-01, 9.07815853e-01],
       [9.31972069e-01, 1.39515730e-02, 2.34362086e-01],
       [6.16778357e-01, 9.49016321e-01, 9.50176119e-01],
       [5.56653188e-01, 9.15606350e-01, 6.41566209e-01],
       [3.90007714e-01, 4.85990667e-01, 6.04310483e-01],
       [5.49547922e-01, 9.26181427e-01, 9.18733436e-01],
       [3.94875613e-01, 9.63262528e-01, 1.73955667e-01],
       [1.26329519e-01, 1.35079158e-01, 5.05662166e-01],
       [2.15248053e-02, 9.47970211e-01, 8.27115471e-01],
       [1.50189807e-02, 1.76196256e-01, 3.32063574e-01],
       [1.30996845e-01, 8.09490692e-01, 3.44736653e-01],
       [9.40107482e-01, 5.82014180e-01, 8.78831984e-01],
       [8.44734445e-01, 9.05392319e-01, 4.59880266e-01],
       [5.46346816e-01, 7.98603591e-01, 2.85718852e-01],
       [4.90253523e-01, 5.99110308e-01, 1.55332756e-02],
       [5.93481408e-01, 4.33676349e-01, 8.07360529e-01],
       [3.15244803e-01, 8.92888709e-01, 5.77857215e-01],
       [1.84010202e-01, 7.87929234e-01, 6.12031177e-01],
       [5.39092721e-02, 4.20193680e-01, 6.79068837e-01],
       [9.18601778e-01, 4.02024891e-04, 9.76759149e-01],
       [3.76580315e-01, 9.73783538e-01, 6.04716101e-01],
       [8.28845808e-01, 5.74711505e-01, 6.28076198e-01],
       [2.85576282e-01, 5.86833341e-01, 7.50021764e-01],
       [8.58313836e-01, 7.55082188e-01, 6.98057248e-01],
       [8.64479430e-01, 3.22680997e-01, 6.70788791e-01],
       [4.50873936e-01, 3.82102752e-01, 4.10811350e-01],
       [4.01479583e-01, 3.17383946e-01, 6.21919368e-01],
       [4.30247271e-01, 9.73802078e-01, 6.77800891e-01],
       [1.98569888e-01, 4.26701009e-01, 3.43346240e-01],
       [7.97638804e-01, 8.79998289e-01, 9.03841956e-01],
       [6.62719812e-01, 2.70208262e-01, 2.52366702e-01],
       [8.54897943e-01, 5.27714646e-01, 8.02161084e-01],
       [5.72488517e-01, 7.33142525e-01, 5.19011627e-01],
       [7.70883911e-01, 5.68857991e-01, 4.65709879e-01],
       [3.42688908e-01, 6.82093484e-02, 3.77924179e-01],
       [7.96260777e-02, 9.82817114e-01, 1.81612851e-01]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">rng</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="c1">#y = 100 by 3 í–‰ë ¬ê³¼ í¬ê¸° 3 ì—´ë²¡í„°ì˜ í–‰ë ¬ê³±
</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>

<span class="n">y</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([ -3.37986709,  10.74767891,  -6.09131716,   8.43244545,
        20.01412846,   4.1934773 ,  -0.35094038,   2.06439823,
        -3.49599876,  -4.43407273,   2.8045874 ,  11.73613282,
         1.84545434,  18.62297315,   7.66471539,   0.28201632,
        -7.04995534,   8.21217837,  10.46412826,   1.08135752,
        -3.20686456,   9.020925  ,   2.80718498,  -9.07917586,
        -8.38474873,   7.27658939,   6.68275817,   8.61155789,
        15.74770923,   2.81707056,  -5.40078872,  -0.95319755,
        16.24978318,  19.35543153,  -4.67346522,  14.97781827,
         9.02197798,   2.9820238 ,  12.62515506,  -0.28833735,
         1.24377741,  10.86442283, -11.98041792,  -2.54929231,
         0.76504876,  17.51417234,  -5.70313302,   6.26514634,
        -3.51841988,   1.35496684,  -2.08336832,  -5.88361643,
        10.86096322,  -4.9367356 ,  -3.88796154,  14.80808349,
        -1.1477796 ,  14.46665226,   0.216072  ,  -0.2871369 ,
         0.32925132,   8.34530304,   5.05066835,  12.7567254 ,
       -14.70672142,   4.87199645,  -8.65569584,  11.98873887,
        -7.85813283,   5.97030505,   7.85318327,  14.14196923,
        -1.12908267, -12.94332059,  -0.21645362,  -6.88756954,
        10.37750735,   1.5342091 ,  16.37077611,   1.52484819,
        13.39370183,  -3.83864459,   1.28380699,  15.36109386,
        -3.1072014 ,  11.8134319 ,   2.18534994,  19.0904709 ,
         3.3314668 ,  10.06412076,   8.62160201,  -8.14847679,
         6.97457881,  -2.33743702,   5.3325264 ,   9.44047459,
        -4.21867229,  -0.07298716,  15.37233961,   2.8022421 ])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(100,)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">intercept_</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">coef_</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.5000000000000018
[ 1.5 -2.   1. ]
</code></pre></div></div>

<p>yê°’ë“¤ì€ ëœë¤í•˜ê²Œ ìƒì„±ëœ 3ì°¨ì›ì˜ xê°’ê³¼ ê³„ìˆ˜ë“¤([1.5, -2., 1.])ì„ ê³±í•¨ìœ¼ë¡œì¨ ìƒì„±ë˜ì—ˆëŠ”ë°, linear regressionì„ í†µí•´ì„œ ì´ ê³„ìˆ˜ë“¤ì„ ê³„ì‚°í•´ë‚¼ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>

<p>ë§Œì•½ ë°ì´í„°ê°€ ì„ í˜•ì ì¸ ê´€ê³„ë¥¼ ê°€ì§€ê³  ìˆì§€ ì•Šë‹¤ë©´?</p>

<h2 id="ì„ í˜•-ê¸°ì €í•¨ìˆ˜-ëª¨ë¸linear-basis-function-models">ì„ í˜• ê¸°ì €í•¨ìˆ˜ ëª¨ë¸(Linear Basis function Models)</h2>
<p>ë¹„ì„ í˜•ë°ì´í„°ë¥¼ ì„ í˜•í•¨ìˆ˜ë¡œ ëª¨ë¸ë§í•˜ëŠ” í•œê°€ì§€ ë§ë²•ì€ ê¸°ì €í•¨ìˆ˜(basis function)ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤. <br />
ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ìŒê³¼ ê°™ì€ ì„ í˜•í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤ê³  í•˜ì. <br />
$ y = a_0 + a_1x_1 + a_2x_2 + a_3x_3 + â€¦$ <br />
ì—¬ê¸°ì„œ $x_1, x_2, x_3$ë“±ì„ 1ì°¨ì› xë¡œ ë¶€í„° ìƒì„±í•  ìˆ˜ ìˆë‹¤. $(x_n = f_n(x))$. $f_n$ì„ ê¸°ì €í•¨ìˆ˜ë¼ê³  ë¶€ë¥¸ë‹¤. <br />
ë§Œì•½ $f_n(x) = x^n$ë¼ëŠ” ê¸°ì €í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ìµœì¢…ì ì¸ ëª¨ë¸ì€ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì´ë‹¤. <br />
$ y = a_0 + a_1x_1 + a_2x_2^2 + a_3x_3^3 + â€¦$ <br />
ì´ ëª¨ë¸ì€ ì—¬ì „íˆ ê³„ìˆ˜$(a_n)$ì— ê´€í•´ì„œëŠ” ì„ í˜•í•¨ìˆ˜ì„ì„ ê¸°ì–µí•˜ì. ë”°ë¼ì„œ 1ì°¨ì› ë³€ìˆ˜ì¸ xë¥¼ ê¸°ì €í•¨ìˆ˜ë¥¼ í†µí•´ ë‹¤ì°¨ì›ìœ¼ë¡œ í™•ì¥ì‹œí‚´ìœ¼ë¡œì¨ ìš°ë¦¬ëŠ” ì—¬ì „íˆ ì„ í˜•ëª¨ë¸(linear regression)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤.</p>

<h3 id="ë‹¤í•­-ê¸°ì €í•¨ìˆ˜polynoial-basis-functions">ë‹¤í•­ ê¸°ì €í•¨ìˆ˜(Polynoial Basis Functions)</h3>
<p>$f_n(x) = x^n$ì˜ í˜•íƒœì˜ í•¨ìˆ˜ë¥¼ ë‹¤í•­ ê¸°ì €í•¨ìˆ˜ë¼ê³  ë¶€ë¥¸ë‹¤. Scikit-Learnì€ PolynomialFeaturesì´ë¼ëŠ” transformerë¥¼ ì´ë¯¸ í¬í•¨í•˜ê³  ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">include_bias</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">poly</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="bp">None</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([[ 2.,  4.,  8.],
       [ 3.,  9., 27.],
       [ 4., 16., 64.]])
</code></pre></div></div>

<p>PolynomialFeaturesê°€ 1ì°¨ì› arrayë¥¼ 3ì°¨ì› arrayë¡œ ë³€í™˜í•œ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ ë³€í™˜ëœ ë°ì´í„°ë¥¼ ì„ í˜•ëª¨ë¸ì— ì ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<p>7ì°¨ì› ë³€í™˜ì„ ì ìš©í•´ë³´ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="n">poly_model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">PolynomialFeatures</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span>
                          <span class="n">LinearRegression</span><span class="p">())</span>
</code></pre></div></div>

<p>ë‹¤ì°¨ì› ë³€í™˜ì„ ì‚¬ìš©í•˜ë©´ ë³µì¡í•œ ë°ì´í„°ë¥¼ ëª¨ë¸ë§í•  ìˆ˜ ìˆê²Œ ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´ sineí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ë°ì´í„°ë¥¼ ìƒì„±í•˜ê³  ëª¨ë¸ë§ í•´ë³´ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">rng</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">rng</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.collections.PathCollection at 0x7fcb8388af10&gt;
</code></pre></div></div>

<p><img src="ML_Basics%28Linear%20Regression%29_files/ML_Basics%28Linear%20Regression%29_19_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poly_model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>
<span class="n">yfit</span> <span class="o">=</span> <span class="n">poly_model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xfit</span><span class="p">[:,</span> <span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">])</span>

<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xfit</span><span class="p">,</span> <span class="n">yfit</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[&lt;matplotlib.lines.Line2D at 0x7fcb8389d110&gt;]
</code></pre></div></div>

<p><img src="ML_Basics%28Linear%20Regression%29_files/ML_Basics%28Linear%20Regression%29_20_1.png" alt="png" /></p>

<h3 id="ê°€ìš°ì‹œì•ˆ-ê¸°ì €í•¨ìˆ˜gaussian-basis-functions">ê°€ìš°ì‹œì•ˆ ê¸°ì €í•¨ìˆ˜(Gaussian Basis Functions)</h3>
<p>ë‹¤í•­ ê¸°ì €í•¨ìˆ˜ ì™¸ì— ë‹¤ë¥¸ ê¸°ì €í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ë³´ì. ê°€ìš°ì‹œì•ˆ ê¸°ì €í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ëœë‹¤. <br />
$exp(- \frac {(x-u_j)^2}{2s^2})$ <br />
$u_j$ëŠ” í•¨ìˆ˜ì˜ ìœ„ì¹˜, sëŠ” í­ì„ ê²°ì •í•œë‹¤. ì£¼ì–´ì§„ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ê°œì˜ ê°€ìš°ì‹œì•ˆ ê¸°ì €í•¨ìˆ˜ë“¤ì˜ í•©ìœ¼ë¡œ í‘œí˜„í•˜ë ¤ê³  ì‹œë„í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">TransformerMixin</span>

<span class="k">class</span> <span class="nc">GaussianFeatures</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">TransformerMixin</span><span class="p">):</span>
    <span class="s">"""Uniformly spaced Gaussian features for one-dimensional input"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">width_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">width_factor</span> <span class="o">=</span> <span class="n">width_factor</span>
    
    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">_gauss_basis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">width</span>
        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">arg</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="p">))</span>
        
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1"># create N centers spread along the data range
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">centers_</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="nb">min</span><span class="p">(),</span> <span class="n">X</span><span class="p">.</span><span class="nb">max</span><span class="p">(),</span> <span class="bp">self</span><span class="p">.</span><span class="n">N</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">width_</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">width_factor</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">centers_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">centers_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span>
        
    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_gauss_basis</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">centers_</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="p">.</span><span class="n">width_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
<span class="n">gauss_model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">GaussianFeatures</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
                            <span class="n">LinearRegression</span><span class="p">())</span>
<span class="n">gauss_model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>
<span class="n">yfit</span> <span class="o">=</span> <span class="n">gauss_model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xfit</span><span class="p">[:,</span> <span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">])</span>

<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xfit</span><span class="p">,</span> <span class="n">yfit</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>

</code></pre></div></div>

<p><img src="ML_Basics%28Linear%20Regression%29_files/ML_Basics%28Linear%20Regression%29_22_0.png" alt="png" /></p>

<h3 id="ê·œì œí™”regularization">ê·œì œí™”(Regularization)</h3>
<p>ê¸°ì €í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë³µì¡í•œ ë°ì´í„°ë¥¼ ëª¨ë¸ë§í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆì§€ë§Œ ì¡°ì‹¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ over-fittingì´ë¼ëŠ” ë‹¤ë¥¸ ì‹¬ê°í•œ ë¬´ì œë¥¼ ë§Œë‚  ìˆ˜ ìˆë‹¤! ì˜ˆë¥¼ë“¤ì–´, ë„ˆë¬´ ë§ì€ ê°œìˆ˜ì˜ ê°€ìš°ì‹œì•ˆ ê¸°ì €í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë  ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">GaussianFeatures</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>
                            <span class="n">LinearRegression</span><span class="p">())</span>
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>
<span class="n">yfit</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xfit</span><span class="p">[:,</span> <span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">])</span>

<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xfit</span><span class="p">,</span> <span class="n">yfit</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(-1.5, 1.5)
</code></pre></div></div>

<p><img src="ML_Basics%28Linear%20Regression%29_files/ML_Basics%28Linear%20Regression%29_24_1.png" alt="png" /></p>

<p>ì´ ì˜ˆì œì—ì„œëŠ” 30ê°œì˜ ê¸°ì €í•¨ìˆ˜ê°€ ì‚¬ìš©ë˜ì—ˆëŠ”ë° ëª¨ë¸ì´ í•„ìš”ì´ìƒìœ¼ë¡œ flexibleí•´ì ¸ì„œ ë°ì´í„°ê°€ ì—†ëŠ” ê³³ì—ì„œëŠ” ê·¹ë‹¨ì ì¸ ê°’ì„ ê°€ì§€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ê¸°ì €í•¨ìˆ˜ì˜ ê³„ìˆ˜ë“¤ì€ ë‹¤ìŒê³¼ ê°™ì´ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">basis_plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">xfit</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xfit</span><span class="p">[:,</span> <span class="n">np</span><span class="p">.</span><span class="n">newaxis</span><span class="p">]))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nb">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s">'x'</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">].</span><span class="n">centers_</span><span class="p">,</span>
               <span class="n">model</span><span class="p">.</span><span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">].</span><span class="n">coef_</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nb">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s">'basis location'</span><span class="p">,</span>
              <span class="n">ylabel</span><span class="o">=</span><span class="s">'coefficient'</span><span class="p">,</span>
              <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    
<span class="n">model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">GaussianFeatures</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">LinearRegression</span><span class="p">())</span>
<span class="n">basis_plot</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="ML_Basics%28Linear%20Regression%29_files/ML_Basics%28Linear%20Regression%29_26_0.png" alt="png" /></p>

<p>ìœ„ ë‘ë²ˆì§¸ ê·¸ë˜í”„ëŠ” ê°ê°ì˜ ê°€ìš°ì‹œì•ˆ ê¸°ì €í•¨ìˆ˜ì˜ í¬ê¸°(ê³„ìˆ˜ê°’)ì„ ë³´ì—¬ì£¼ê³  ìˆë‹¤. Over-fittingì´ ì¼ì–´ë‚˜ëŠ” ì˜ì—­ì—ì„œëŠ” ì¸ì ‘í•œ ê¸°ì €í•¨ìˆ˜ë“¤ì˜ ê°’ì´ ê·¹ë‹¨ìœ¼ë¡œ ê°€ë©´ì„œ ì„œë¡œ ìƒì‡„í•˜ëŠ” í˜„ìƒì´ ì¼ì–´ë‚œë‹¤. ë”°ë¼ì„œ í° ê³„ìˆ˜ê°’ì— ëŒ€í•´ penaltyë¥¼ ë¶€ì—¬í•´ì„œ over-fittingì„ ì–´ëŠ ì •ë„ ê·¹ë³µí•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. ì´ëŸ¬í•œ penaltyë¥¼ regularizationì´ë¼ ë¶€ë¥¸ë‹¤.</p>

<h3 id="ridge-regressionl2-regularization">Ridge regression(L2 Regularization)</h3>
<p>ê°€ì¥ ìì£¼ ì“°ì´ëŠ” í˜•íƒœì˜ regularizationì€ ridge regression(L2 regularization)ì´ê³  ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ëœë‹¤. <br />
$ P = \alpha \sum_{n=1}^N \theta_n^2$ <br />
ì—¬ê¸°ì„œ $\alpha$ëŠ” regularizationì˜ ê°•ë„ë¥¼ ì¡°ì ˆí•˜ëŠ” íŒŒë¼ë¯¸í„°ì´ë‹¤. ì´ í˜•íƒœì˜ regularizationì€ Scikit-Learnì˜ Ridge estimatorì—ì„œ ì‚¬ìš©ëœë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">GaussianFeatures</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>
<span class="n">basis_plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">'Ridge Regression'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="ML_Basics%28Linear%20Regression%29_files/ML_Basics%28Linear%20Regression%29_29_0.png" alt="png" /></p>

<p>$\alpha$ê°’ì´ 0ì— ê°€ê¹Œì›Œì§ˆìˆ˜ë¡ ì¼ë°˜ì ì¸ ì„ í˜•íšŒê·€ëª¨ë¸ì´ ë˜ê³ , $\alpha$ê°’ì´ ë¬´í•œëŒ€ë¡œ ì¦ê°€í•˜ë©´ ë°ì´í„°ëŠ” ëª¨ë¸ì— ì˜í–¥ì„ ì£¼ì§€ ì•Šê²Œ ëœë‹¤.</p>

<h3 id="lasso-regression-l1-regularization">Lasso Regression (L1 Regularization)</h3>
<p>ë˜ í•˜ë‚˜ì˜ ìì£¼ ì“°ì´ëŠ” regularization ë°©ë²•ì€ ê³„ìˆ˜ë“¤ì˜ ì ˆëŒ€ê°’ì˜ í•©ì„ ì œí•œí•˜ëŠ” ê²ƒì´ë‹¤. <br />
$ P = \alpha \sum_{n=1}^N \vert \theta_n \vert $ <br />
ë’¤ì—ì„œ ìì„¸íˆ ë‹¤ë£¨ê² ì§€ë§Œ ì´ ë°©ë²•ì€ sparseí•œ ëª¨ë¸ì„ ìƒì„±í•˜ê²Œ ëœë‹¤.(ë§ì€ê³„ìˆ˜ë“¤ì´ 0ì´ë¨)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">GaussianFeatures</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.001</span><span class="p">))</span>
<span class="n">basis_plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">'Lasso Regression'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Users/sumin/opt/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/coordinate_descent.py:475: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.002135815870488389, tolerance: 0.002065280097246271
  positive)
</code></pre></div></div>

<p><img src="ML_Basics%28Linear%20Regression%29_files/ML_Basics%28Linear%20Regression%29_32_1.png" alt="png" /></p>

<p>ìœ„ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ ëŒ€ë¶€ë¶„ì˜ ê³„ìˆ˜ê°’ë“¤ì´ 0ì´ ëœë‹¤. Ridge regressionê³¼ ë§ˆì°¬ê°€ì§€ë¡œ $\alpha$ê°’ìœ¼ë¡œ regularizationì˜ ê°•ë„ë¥¼ ì¡°ì ˆí•  ìˆ˜ ìˆë‹¤.</p>

<h3 id="sgd">SGD</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDRegressor</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">GaussianFeatures</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>
                     <span class="n">SGDRegressor</span><span class="p">(</span><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">basis_plot</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Users/sumin/opt/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/stochastic_gradient.py:1185: ConvergenceWarning: Maximum number of iteration reached before convergence. Consider increasing max_iter to improve the fit.
  ConvergenceWarning)
</code></pre></div></div>

<p><img src="ML_Basics%28Linear%20Regression%29_files/ML_Basics%28Linear%20Regression%29_35_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

:ET