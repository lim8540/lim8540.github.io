---
category: programmers
tags: [K-digital training, week2_day5, 인공지능 수학]
use_math: true
---

## 추정

- 구간추정
    - 모평균 $\mu$의 $100(1-\alpha)\%$ 신뢰구간(confidence interval)
        - $(\mu의 추정량) \pm z_{\alpha \over 2} (추정량의 표준편차)$
    - 정규분포에서 $\sigma$를 알 때,
        - $(\bar {x} - z_{\alpha / 2}{\sigma \over {\sqrt n}}  ,  \bar {x} + z_{\alpha / 2}{\sigma \over {\sqrt n}} )$
        - 그러나 이 방법은 실용적이지 못하다: 정규분포가 아니거나 표준편차가 알려져 있지 않은 경우가 많다.
    - 표본의 크기가 클 때, 중심극한 정리를 사용한다.
        - $(\mu의 추정량) \pm z_{\alpha \over 2} (추정량의 표준편차)$ 
            - $(\bar {x} - z_{\alpha / 2}{s \over {\sqrt n}}  ,  \bar {x} + z_{\alpha / 2}{s \over {\sqrt n}} )$
            - $s$ : 표본표준편차

- 예시 : 어떤 학교의 고1 남학생의 평균키를 추정하기 위해 36명을 표본으로 추출하여 그 표본평균과 표본표준편차를 계산하여 그 결과가 아래와 같았다.
        - $\bar {x} = 173.6, s = 3.6$
        - 평균키에 대한 95% 신뢰구간을 구하시오.
    - 해결 :
        - $\alpha = 0.05$(95%신뢰수준이므로)
        - $z_{\alpha / 2} = z_{0.025} = 1.96$
        - $z_{\alpha / 2}{s \over {\sqrt n}} = 1.96 \times {3.6 \over 6} = 1.176$
        - 95% 신뢰구간 : $(173.6 - 1.176, 173.6 + 1.176) = (172.4, 174.8)$
    - 데이터가 주어졌을 때, python으로 계산하기
        - 어떤 농장에서 생산된 계란 30개의 표본의 무게는 다음과 같았다. 계란의 평균 무게에 대한 95% 신뢰 구간을 구하시오.
        - $w = [10.7, 11.7, 9.8, ...]$
```python
import numpy as np
>>> w  = [10.7, 11.7, 9.8, 11.4, 10.8, 9.9, 10.1, 8.8, 12.2, 11.0, 11.3, 11.1, 10.3, 10.0, 9.9, 11.1, 11.7, 11.5, 9.1, 10.3, 8.6, 12.1, 10.0, 13.0, 9.2, 9.8, 9.3, 9.4, 9.6, 9.2]
>>> xbar = np.mean(w)
>>> sd = np.std(w, ddof = 1)
>>> import scipy.stats
>>> alpha = 0.05
# 전체 확률 1에서 오른쪽부분은 0.025를 뺀 부분의 z값
>>> zalpha = scipy.stats.norm.ppf(1-alpha/2)
>>> print("평균 %.2f, 표준편차: %.2f" %(xbar, sd))
평균 10.43, 표준편차: 1.11
>>> print(zalpha :" zalpha)
zalpha : 1.959963984540054
```
    따라서, 95% 신뢰 구간 : $(10.43 - 1.96 \times {1.11 \over {\sqrt 30}} , 10.43 + 1.96 \times {1.11 \over {\sqrt 30}}) = (10.033, 10.827)$

- 예시 2

    - 대학교 1학년생의 흡연율을 조사하기 위해 150명을 랜덤하게 선택하여 흡연여부를 조사하였다. 이 중 48명이 흡연을 하고 있었다. 이 대학교 1학년생의 흡연율의 평균을 점추정하시오.
    - 점 추정
        - 확률변수 X:
            - n개의 표본에서 특정 속성을 갖는 표본의 개수
        - 모비율 p의 점추정량
            - $\hat {p} = {x \over n}$
        - $n = 150, X=48$
        - $\hat {p} = {X \over n} = {48 \over 150} = 0.32$
        - 평균 흡연율은 32%로 추정됨
    - 구간추정
        - n이 충분히 클 때($n\hat{p} \gt 5, n(1-{\hat p }) \gt 5$일 때를 의미)
        - $X \sim N(np,np(1-p))$
        - 모비율 p의 $100(1-\alpha)\%$ 신뢰구간 (confidence interval) (증명생략)
            - $(\hat{p} - z_{\alpha \over 2} {\sqrt { {\hat {p} (1 - \hat {p}) } \over n} }, \hat{p} + z_{\alpha \over 2} {\sqrt { {\hat {p} (1 - \hat {p}) } \over n} })$

        - ${\sqrt { {\hat {p} (1 - \hat {p}) } \over n} } = {\sqrt { {(0.32) (0.68) } \over 150} } = 0.038$
        - $(0.32 - 1.96 \times 0.038, 0.32 + 1.96 \times 0.038) = (0.245, 0.395)$